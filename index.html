<html>
<head>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="vis.min.js"></script>
    <link href="vis.min.css" rel="stylesheet" type="text/css" />
    <meta charset="utf-8">
</head>
<body>
<div id="grafo"></div>

<script type="text/javascript">
    $.ajax({
        url: 'data/informatica-1986.csv',
        dataType: 'text',
        success: function(data, jqXHR, textStatus) {graphFromCSV(data)}
    })

    function graphFromCSV(data) {
        var nodes_arr = new Array()
        var groups_arr = new Array()
        var nodes = new vis.DataSet([])
        var edges = new vis.DataSet([])

        var allRows = data.split(/\r?\n|\r/);
        for (var singleRow = 1; singleRow < allRows.length-1; singleRow++) {
            var rowCells = allRows[singleRow].split(',');
            var name = '[' + rowCells[0] + '] ' + rowCells[1] + ' -- ' + rowCells[2] + ' crÃ©ditos' + ' -- (' + rowCells[4] + ')'
            if ($.inArray(rowCells[0],nodes_arr) == -1) {
                nodes_arr.push(rowCells[0])
                nodes.add({id:rowCells[0], label:rowCells[1], title:name, group:rowCells[4]})
            }

            if ($.inArray(rowCells[4],groups_arr) == -1) {
                groups_arr.push(rowCells[4])
                nodes.add({id:rowCells[4], label:rowCells[4], group:rowCells[4]})
            }

            var correlativas = rowCells[3].split('-')
            correlativas.forEach(x => {
                edges.add({from:x,to:rowCells[0]})
            });
        } 
        
        var container = document.getElementById('grafo');

        var data = {
            nodes: nodes,
            edges: edges
        };
        var options = {
            edges:{
                arrows: {
                    to:     {enabled: true, scaleFactor:1, type:'arrow'}
                },
            }
        };

        var network = new vis.Network(container, data, options);
}



</script>
</body>
</html>